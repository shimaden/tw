#!/usr/bin/ruby2.5
# encoding: UTF-8
# このコードはＵＴＦ－８です。
#
# This file was generated by RubyGems.
#
# The application 'us' is installed as part of a gem, and
# this file is here to facilitate running it.
#
ENV['TWBT'] = ""

sigint_handler = Proc.new() do
  $stderr.puts()
  $stderr.puts("あ～ん")
  $stderr.puts("SIGINT")
  #@logger.debug("SIGINT")
  exit 0
end
Signal.trap(:INT, sigint_handler)

CLIENT_NAME = File.basename(__FILE__, '.*').freeze
if CLIENT_NAME.nil? || CLIENT_NAME.length == 0 then
  raise RuntimeError.new("Wrong client name: #{CLIENT_NAME.inspect}")
end

def platform()
  platform = nil
  begin
    IO.popen("uname", "r") do |io|
      platform = io.gets
    end
  rescue Errno::ENOENT => e
  end
  if platform.nil? then
    if ENV['OS'] =~ /Windows_NT/i then
      platform = 'Windows_NT'
    end
  end
  return platform
end

PLATFORM = platform()
if PLATFORM =~ /Linux/i then
  $LOAD_PATH.push("#{ENV['HOME']}/mysrc/ruby/us/lib")
elsif PLATFORM =~ /Windows_NT/i then
  $LOAD_PATH.push('P:/mysrc/ruby/us/lib')
else
  $stderr.puts("#{CLIENT_NAME}: warning: unknown platform.")
end

require 'rubygems'
require 'requirer'
require 'app/main'

version = ">= 0"

if ARGV.first then
  str = ARGV.first
  str = str.dup.force_encoding("BINARY") if str.respond_to? :force_encoding
  if str =~ /\A_(.*)_\z/ then
    version = $1
    ARGV.shift
  end
end

$:.unshift File.expand_path '../lib', File.dirname(__FILE__)
$stdout.sync = true

ret = Tw::App::Main.new().run(ARGV)
exit ret
